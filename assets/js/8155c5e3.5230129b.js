"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[32],{47:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>n,metadata:()=>l,toc:()=>s});var a=r(8168),i=(r(6540),r(5680));const n={sidebar_position:1},o="Introduction",l={unversionedId:"time-card/introduction",id:"time-card/introduction",title:"Introduction",description:"Spec revision 1.0",source:"@site/docs/time-card/introduction.md",sourceDirName:"time-card",slug:"/time-card/introduction",permalink:"/Time-Appliance-Project/docs/time-card/introduction",draft:!1,editUrl:"https://github.com/opencomputeproject/Time-Appliance-Project/tree/master/website/docs/time-card/introduction.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Timecard",permalink:"/Time-Appliance-Project/docs/category/timecard"},next:{title:"System Installation",permalink:"/Time-Appliance-Project/docs/time-card/installation"}},c={},s=[{value:"Spec revision 1.0",id:"spec-revision-10",level:4},{value:"General",id:"general",level:2},{value:"Form Factor",id:"form-factor",level:2},{value:"GNSS",id:"gnss",level:2},{value:"Receiver",id:"receiver",level:3},{value:"Security",id:"security",level:3},{value:"Jamming",id:"jamming",level:3},{value:"Spoofing",id:"spoofing",level:3},{value:"Clock",id:"clock",level:2},{value:"Bridge",id:"bridge",level:2},{value:"Hardware Implementation",id:"hardware-implementation",level:3},{value:"Software Implementation",id:"software-implementation",level:3},{value:"Interfaces",id:"interfaces",level:2},{value:"LED",id:"led",level:3},{value:"Precision",id:"precision",level:2},{value:"Repository content",id:"repository-content",level:2},{value:"Where can I get one?",id:"where-can-i-get-one",level:2}],p={toc:s},m="wrapper";function u(e){let{components:t,...r}=e;return(0,i.yg)(m,(0,a.A)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"introduction"},"Introduction"),(0,i.yg)("h4",{id:"spec-revision-10"},"Spec revision 1.0"),(0,i.yg)("p",null,"Time Card is the heart of the ",(0,i.yg)("a",{parentName:"p",href:"http://www.opentimeserver.com"},"Open Time Server")," Project.",(0,i.yg)("br",{parentName:"p"}),"\n","This spec can be accessed using ",(0,i.yg)("a",{parentName:"p",href:"http://www.timingcard.com"},"http://www.timingcard.com")),(0,i.yg)("img",{width:"1214",alt:"timingcard",src:"https://github.com/user-attachments/assets/f8af40c1-11fd-4eca-a625-c8c28ff6f0e7"}),(0,i.yg)("h2",{id:"general"},"General"),(0,i.yg)("p",null,"Time Master is a critical part of a PTP enabled network. It provides accurate time via GNSS while maintaining accuracy in case of GNSS failure via a high stability (and holdover) oscillator such as an atomic clock. Existing products in the market are often closed sourced and are far from having sufficient features. The Time Card project presents an open source solution via a PCIe card."),(0,i.yg)("h2",{id:"form-factor"},"Form Factor"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Standard PCIe Stand-up Card"),(0,i.yg)("li",{parentName:"ul"},"Single Slot - Passive Cooling Solution")),(0,i.yg)("h2",{id:"gnss"},"GNSS"),(0,i.yg)("h3",{id:"receiver"},"Receiver"),(0,i.yg)("p",null,"The GNSS receiver can be a product from ublock or any other vendor as long as it provides PPS output and the TOD using any suitable format."),(0,i.yg)("p",null,"This is the recommended module: ",(0,i.yg)("strong",{parentName:"p"},"u-blox RCB-F9T GNSS time module")),(0,i.yg)("p",null,(0,i.yg)("img",{parentName:"p",src:"https://content.u-blox.com/sites/default/files/products/RCB-F9T_PCBVer-C.png",alt:"GNSS Receiver"})),(0,i.yg)("p",{align:"center"},"GNSS Receiver"),(0,i.yg)("h3",{id:"security"},"Security"),(0,i.yg)("p",null,"There are 2 main attack vectors on GNSS receiver"),(0,i.yg)("h3",{id:"jamming"},"Jamming"),(0,i.yg)("p",null,"Jamming is the simplest form of attack. In order to keep operations while under attack the most reliable approach is to perform a long run holdover.",(0,i.yg)("br",{parentName:"p"}),"\n","See more about holdover in the ",(0,i.yg)("a",{parentName:"p",href:"#Clock"},"clock")," section."),(0,i.yg)("h3",{id:"spoofing"},"Spoofing"),(0,i.yg)("p",null,"GNSS authenticity is relevant today. A mechanism to protect against over-the-air spoofing incidents is desirable. With special equipment it is possible to simulate a GNSS constellation and spoof the receiver. Basic principals to protect against such attack:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Use high-quality GNSS receivers which verify packet signature"),(0,i.yg)("li",{parentName:"ul"},"Disciplining implementations see more in ",(0,i.yg)("a",{parentName:"li",href:"#bridge"},"bridge")," section should protect against sudden jumps in time and space. For the datacenter use cases jump in space could be completely forbidden.")),(0,i.yg)("h2",{id:"clock"},"Clock"),(0,i.yg)("p",null,'GNSS requires "clear sky" to function properly. Moreover there were several historical events of a short term time jumps by some GNSS constallations. Because of reliability and in combination with the security concerns an additional holdover should be performed by ',(0,i.yg)("a",{parentName:"p",href:"https://www.meinbergglobal.com/english/specs/gpsopt.htm"},"high quality")," XO. An example could be AC, OCXO, TCXO etc. In order to perform sustainable operation we recommend to use an AC with a holdover \xb1 1us or HQ OCXO with a holdover \xb1 22 \xb5s."),(0,i.yg)("p",null,"Atomic clock examples:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.microsemi.com/product-directory/embedded-clocks-frequency-references/5570-miniature-atomic-clock-mac-sa5x"},"SA5X")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.orolia.com/products/atomic-clocks-oscillators/mro-50"},"mRO-50")),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.microsemi.com/product-directory/embedded-clocks-frequency-references/5207-space-csac"},"SA.45s"))),(0,i.yg)("p",null,"OCXO examples:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.sitime.com/products/stratum-3e-ocxos/sit5711"},"SiT5711"))),(0,i.yg)("p",null,"TCXO examples:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("a",{parentName:"li",href:"https://www.sitime.com/products/super-tcxo/sit5356"},"SiT5356"))),(0,i.yg)("h2",{id:"bridge"},"Bridge"),(0,i.yg)("p",null,"The bridge between the GNSS receiver and the Atomic clock can be implemented using software or hardware solutions. The hardware implementation is preferred and is our end goal."),(0,i.yg)("h3",{id:"hardware-implementation"},"Hardware Implementation"),(0,i.yg)("p",null,"Here is one of the examples of hardware implementations."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"FPGA is responsible for most of the functionality"),(0,i.yg)("li",{parentName:"ul"},"Exposed /dev/phc and /dev/pps are read by open source software such as ptp4l and chronyd")),(0,i.yg)("p",null,(0,i.yg)("img",{parentName:"p",src:"https://raw.githubusercontent.com/opencomputeproject/Time-Appliance-Project/master/Time-Card/images/idea.png",alt:"Time Card - Block Diagram"})," ",(0,i.yg)("img",{parentName:"p",src:"https://raw.githubusercontent.com/opencomputeproject/Time-Appliance-Project/master/Time-Card/images/block1.png",alt:"Bridge Block Diagram 1"})," ",(0,i.yg)("img",{parentName:"p",src:"https://raw.githubusercontent.com/opencomputeproject/Time-Appliance-Project/master/Time-Card/images/block2.png",alt:"Bridge Block Diagram 2"})," ",(0,i.yg)("img",{parentName:"p",src:"https://raw.githubusercontent.com/opencomputeproject/Time-Appliance-Project/master/Time-Card/images/block3.png",alt:"Bridge Block Diagram 3"})),(0,i.yg)("h3",{id:"software-implementation"},"Software Implementation"),(0,i.yg)("p",null,"Software implementation still requires most of the components, however the communication between components is done with user space software:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"GPSd exposing ",(0,i.yg)("inlineCode",{parentName:"li"},"/dev/ppsY")," and provides ",(0,i.yg)("inlineCode",{parentName:"li"},"TOD")," via ",(0,i.yg)("inlineCode",{parentName:"li"},"SHM")),(0,i.yg)("li",{parentName:"ul"},"FPGA board reads 1 PPS from different sources"),(0,i.yg)("li",{parentName:"ul"},"Host daemon monitors the offset and steers oscillator"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"phc2sys")," can copy data between clocks, including between GPSd and Atomic and then Atomic to PHC on the NIC")),(0,i.yg)("h2",{id:"interfaces"},"Interfaces"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"PCIe",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},"PCIe x1 (18 pins) generation 1.0 or above on a x4 form-factor"),(0,i.yg)("li",{parentName:"ul"},"Generic, supporting multiple OS versions"),(0,i.yg)("li",{parentName:"ul"},"Exposes PHC device in Linux (",(0,i.yg)("inlineCode",{parentName:"li"},"/dev/ptpX"),") as well as PPS (",(0,i.yg)("inlineCode",{parentName:"li"},"/dev/ppsY"),")"),(0,i.yg)("li",{parentName:"ul"},"Exposes leap second indicator to a shared memory segment read by ",(0,i.yg)("inlineCode",{parentName:"li"},"chrony/ptp4l")))),(0,i.yg)("li",{parentName:"ul"},"1PPS / 10MHz SMA output"),(0,i.yg)("li",{parentName:"ul"},"1PPS / 10MHz SMA input"),(0,i.yg)("li",{parentName:"ul"},"IRIG-B input output"),(0,i.yg)("li",{parentName:"ul"},"DCF77 input output"),(0,i.yg)("li",{parentName:"ul"},"GNSS Antenna SMA input")),(0,i.yg)("h3",{id:"led"},"LED"),(0,i.yg)("p",null,"An LED should be used to provide externally visible status information of the time card."),(0,i.yg)("p",null,"LED status signals:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Off - card is not powered or not properly fitted"),(0,i.yg)("li",{parentName:"ul"},"Solid green - card is powered, GNSS ok, 1PPS/10MHz output ok"),(0,i.yg)("li",{parentName:"ul"},"Flashing green - card is in warm-up, acquiring satellites"),(0,i.yg)("li",{parentName:"ul"},"Solid red - alarm / malfunction")),(0,i.yg)("h2",{id:"precision"},"Precision"),(0,i.yg)("p",null,"Time card has 4 SMA connectors that can be configured as outputs and outputs for various things such as 10Mhz, PHC, MAC, GNSS, GNSS2, IRIG, DCF for output and 10Mhz, PPS1, PPS2, TS1, TS2, IRIG, DCF for input.",(0,i.yg)("br",{parentName:"p"}),"\n","Using a Calnex Sentinel device are comparing various things. Here we are comparing the 1PPS output (Channel A) and the 10Mhz output (Channel B) from the MAC (SA.53)."),(0,i.yg)("img",{width:"799",alt:"MACvs10Mhz",src:"https://github.com/user-attachments/assets/7e6a31ec-0f20-46c5-8f1f-8b98d448d518"}),(0,i.yg)("h2",{id:"repository-content"},"Repository content"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"Bill of Materials (parts from Digikey)"),(0,i.yg)("li",{parentName:"ul"},"Schematic and PCB of the time card"),(0,i.yg)("li",{parentName:"ul"},"Driver (Kernel Module) CentOS 8"),(0,i.yg)("li",{parentName:"ul"},"CAD files for the custom PCIe bracket")),(0,i.yg)("h2",{id:"where-can-i-get-one"},"Where can I get one?"),(0,i.yg)("p",null,"You have all the necessary source code, BOM, Gerber files, and binaries to build it yourself. However, we are currently working with several suppliers and will have their contact info soon available to allow you to purchase an out-of-the-box ready Time Card."),(0,i.yg)("p",null,"If you don't want to build your own then they are commercially available via Makerfabs. For ordering go to:\n",(0,i.yg)("a",{parentName:"p",href:"https://www.makerfabs.com/ocp-tap-time-card.html"},"https://www.makerfabs.com/ocp-tap-time-card.html")," or make a PCBA order on PCBWay or JLCPCB, depending on your technical apetite."))}u.isMDXComponent=!0},5680:(e,t,r)=>{r.d(t,{xA:()=>p,yg:()=>g});var a=r(6540);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,i=function(e,t){if(null==e)return{};var r,a,i={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var c=a.createContext({}),s=function(e){var t=a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,i=e.mdxType,n=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=s(r),d=i,g=m["".concat(c,".").concat(d)]||m[d]||u[d]||n;return r?a.createElement(g,o(o({ref:t},p),{},{components:r})):a.createElement(g,o({ref:t},p))}));function g(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var n=r.length,o=new Array(n);o[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[m]="string"==typeof e?e:i,o[1]=l;for(var s=2;s<n;s++)o[s]=r[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"}}]);